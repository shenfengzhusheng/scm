!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("angular"));else if("function"==typeof define&&define.amd)define(["angular"],t);else{var n="object"==typeof exports?t(require("angular")):t(e.angular);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";n.r(t);var o={};n.d(o,"map",function(){return a}),n.d(o,"offline",function(){return l}),n.d(o,"offlineLabel",function(){return u});var r=n(0),i=n.n(r),a={width:"100%",height:"100%",display:"none"},l={width:"100%",height:"100%",backgroundColor:"#E6E6E6",position:"relative",display:"none"},u={fontSize:"30px",margin:0,position:"absolute",top:"50%",left:"50%","margin-right":"-50%",transform:"translate(-50%, -50%)"};function s(e,t){if(c(e))throw new Error(t)}function c(e){return null===e||void 0===e}function p(e){return void 0===e}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}var f=["navigation","overviewmap","scale","maptype","copyright","geolocation","panorama"];var y=["heatmap"];var h={longitude:121.506191,latitude:31.245554},m=10;function v(e,t){c(t)||c(t.disableDragging)||e[(t.disableDragging?"disable":"enable")+"Dragging"](),c(t)||c(t.enableScrollWheelZoom)||e[(t.enableScrollWheelZoom?"enable":"disable")+"ScrollWheelZoom"](),c(t)||c(t.disableDoubleClickZoom)||e[(t.disableDoubleClickZoom?"disable":"enable")+"DoubleClickZoom"](),c(t)||c(t.enableKeyboard)||e[(t.enableKeyboard?"enable":"disable")+"Keyboard"](),c(t)||c(t.enableInertialDragging)||e[(t.enableInertialDragging?"enable":"disable")+"InertialDragging"](),c(t)||c(t.enableContinuousZoom)||e[(t.enableContinuousZoom?"enable":"disable")+"ContinuousZoom"](),c(t)||c(t.disablePinchToZoom)||e[(t.disablePinchToZoom?"disable":"enable")+"PinchToZoom"](),!c(t)&&!c(t.cursor)&&e.setDefaultCursor(t.cursor),!c(t)&&!c(t.draggingCursor)&&e.setDraggingCursor(t.draggingCursor),!c(t)&&!c(t.currentCity)&&e.setCurrentCity(t.currentCity),!c(t)&&!c(t.centerAndZoom)&&e.centerAndZoom(new BMap.Point(t.centerAndZoom.longitude||h.longitude,t.centerAndZoom.latitude||h.latitude),t.centerAndZoom.zoom||m)}var b=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var g={bindings:{offlineTxt:"<",mapOptions:"<",loaded:"&",click:"&"},transclude:!0,template:'\n        <div ng-style="$ctrl.style.map" class="baidu-map-instance"></div>\n        <div ng-style="$ctrl.style.offline" class="baidu-map-offline">\n            <label ng-style="$ctrl.style.offlineLabel">{{ $ctrl.offlineTxt || \'NO_NETWORK\' }}</label>\n        </div>\n        <div ng-transclude style="display: none"></div>\n    ',controller:function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$element=n,this.$attrs=r,this.style=o,this.mapScriptService=i}return e.$inject=["$scope","$element","$attrs","mapScriptService"],b(e,[{key:"$onInit",value:function(){var e=this;this.mapReady=this.mapScriptService.load().then(function(){return t=e.$element.children()[0],n=e.mapOptions,v(o=new BMap.Map(t,n),n),o;var t,n,o}).then(function(t){return e.loaded({map:t}),e.$scope.$apply(),e.map=t}).then(function(){if(e.$attrs.click){var t=e.clickListener=function(t){e.click({e:t}),e.$scope.$apply()};e.map.addEventListener("click",t)}})}},{key:"$onChanges",value:function(e){this.map&&v(this.map,e.mapOptions.currentValue)}},{key:"$onDestroy",value:function(){this.map.removeEventListener("click",this.clickListener)}},{key:"addOverlay",value:function(e){return w(this.map,"addOverlay",e)}},{key:"removeOverlay",value:function(e){return w(this.map,"removeOverlay",e)}},{key:"addControl",value:function(e){return w(this.map,"addControl",e)}},{key:"removeControl",value:function(e){return w(this.map,"removeControl",e)}},{key:"getMap",value:function(){return this.map}}]),e}()};function w(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];return new Promise(function(n){e[t].apply(e,o),n()})}function C(e,t){var n={url:e.url};return s(e.url,"url is required in "+t),s(e.size,"size is required in "+t),n.size=O(e.size,t+".size"),new BMap.Icon(n.url,n.size)}function O(e,t){return s(e.width,"width is required in "+t),s(e.height,"height is required in "+t),new BMap.Size(e.width,e.height)}function k(e,t){return s(e.longitude,"longitude is required in "+t),s(e.latitude,"latitude is required in "+t),new BMap.Point(e.longitude,e.latitude)}function M(e,t){return function(e,t){if(!d(e))throw new Error(t)}(e,t+" must be Array"),e.map(function(e){return s(e.longitude,"longitude is required in "+t),s(e.latitude,"latitude is required in "+t),new BMap.Point(e.longitude,e.latitude)})}var A=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var P={bindings:{point:"<",options:"<",loaded:"&",click:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$attrs=n}return e.$inject=["$scope","$attrs"],A(e,[{key:"$onInit",value:function(){var e=this;s(this.point,"point is required for <marker>"),this.mapCtrl.mapReady.then(function(){var t=k(e.point,"<marker> point"),n=function(e){var t=JSON.parse(JSON.stringify(e||{}));t.offset&&(t.offset=O(t.offset,"<marker> options.offset"));t.icon&&(t.icon=C(t.icon,"<marker> options.icon"));t.shadow&&(t.shadow=C(t.shadow,"<marker> options.shadow"));return t}(e.options),o=e.marker=new BMap.Marker(t,n);return e.mapCtrl.addOverlay(o),o}).then(function(t){e.loaded({marker:t}),e.$scope.$apply(),e.$attrs.click&&(e.clickHandler=function(n){e.click({e:n,marker:t,map:e.mapCtrl.getMap()}),e.$scope.$apply()},t.addEventListener("click",e.clickHandler))})}},{key:"$onChanges",value:function(e){this.marker&&e.point&&e.point.currentValue&&this.marker.setPosition(k(e.point.currentValue,"<marker> point"))}},{key:"$onDestroy",value:function(){this.marker.removeEventListener("click",this.clickHandler),this.mapCtrl.removeOverlay(this.marker)}}]),e}()};var _=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var $={bindings:{points:"<",options:"<",loaded:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$attrs=n}return e.$inject=["$scope","$attrs"],_(e,[{key:"$onInit",value:function(){var e=this;s(this.points,"points is required for <polyline>"),this.mapCtrl.mapReady.then(function(){var t=M(e.points,"<polyline> points"),n=e.options,o=e.polyline=new BMap.Polyline(t,n);return e.mapCtrl.addOverlay(o),o}).then(function(t){e.loaded({polyline:t}),e.$scope.$apply()})}},{key:"$onChanges",value:function(e){this.polyline&&(e.points&&e.points.currentValue&&this.polyline.setPath(M(e.points.currentValue,"<polyline> points")),e.options&&e.options.currentValue&&(p(e.options.currentValue.strokeColor)||this.polyline.setStrokeColor(e.options.currentValue.strokeColor),p(e.options.currentValue.strokeWeight)||this.polyline.setStrokeWeight(e.options.currentValue.strokeWeight),p(e.options.currentValue.strokeOpacity)||this.polyline.setStrokeOpacity(e.options.currentValue.strokeOpacity),p(e.options.currentValue.strokeStyle)||this.polyline.setStrokeStyle(e.options.currentValue.strokeStyle),p(e.options.currentValue.enableMassClear)||this.polyline[e.options.currentValue.enableMassClear?"enableMassClear":"disableMassClear"](),p(e.options.currentValue.enableEditing)||this.polyline[e.options.currentValue.enableEditing?"enableEditing":"disableEditing"]()))}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.polyline)}}]),e}()},V=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var E={bindings:{center:"<",radius:"<",options:"<",loaded:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$attrs=n}return e.$inject=["$scope","$attrs"],V(e,[{key:"$onInit",value:function(){var e=this;s(this.center,"center is required for <circle>"),s(this.radius,"radius is required for <circle>"),this.mapCtrl.mapReady.then(function(){var t=e.center,n=e.radius,o=e.options,r=k(t,"<circle> center"),i=e.circle=new BMap.Circle(r,n,o);return e.mapCtrl.addOverlay(i),i}).then(function(t){e.loaded({circle:t}),e.$scope.$apply()})}},{key:"$onChanges",value:function(e){this.circle&&(e.center&&e.center.currentValue&&this.circle.setCenter(k(e.center.currentValue,"<circle> center")),e.radius&&e.radius.currentValue&&this.circle.setRadius(e.radius.currentValue),e.options&&e.options.currentValue&&(p(e.options.currentValue.strokeColor)||this.circle.setStrokeColor(e.options.currentValue.strokeColor),p(e.options.currentValue.strokeWeight)||this.circle.setStrokeWeight(e.options.currentValue.strokeWeight),p(e.options.currentValue.strokeOpacity)||this.circle.setStrokeOpacity(e.options.currentValue.strokeOpacity),p(e.options.currentValue.strokeStyle)||this.circle.setStrokeStyle(e.options.currentValue.strokeStyle),p(e.options.currentValue.fillOpacity)||this.circle.setFillOpacity(e.options.currentValue.fillOpacity),p(e.options.currentValue.fillColor)||this.circle.setFillColor(e.options.currentValue.fillColor),p(e.options.currentValue.enableMassClear)||this.circle[e.options.currentValue.enableMassClear?"enableMassClear":"disableMassClear"](),p(e.options.currentValue.enableEditing)||this.circle[e.options.currentValue.enableEditing?"enableEditing":"disableEditing"]()))}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.circle)}}]),e}()},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var S={bindings:{points:"<",options:"<",loaded:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$attrs=n}return e.$inject=["$scope","$attrs"],T(e,[{key:"$onInit",value:function(){var e=this;s(this.points,"points is required for <polygon>"),this.mapCtrl.mapReady.then(function(){var t=M(e.points,"<polygon> points"),n=e.options,o=e.polygon=new BMap.Polygon(t,n);return e.mapCtrl.addOverlay(o),o}).then(function(t){e.loaded({polygon:t}),e.$scope.$apply()})}},{key:"$onChanges",value:function(e){this.polygon&&(e.points&&e.points.currentValue&&this.polygon.setPath(M(e.points.currentValue,"<polygon> points")),e.options&&e.options.currentValue&&(p(e.options.currentValue.strokeColor)||this.polygon.setStrokeColor(e.options.currentValue.strokeColor),p(e.options.currentValue.fillColor)||this.polygon.setFillColor(e.options.currentValue.fillColor),p(e.options.currentValue.strokeWeight)||this.polygon.setStrokeWeight(e.options.currentValue.strokeWeight),p(e.options.currentValue.strokeOpacity)||this.polygon.setStrokeOpacity(e.options.currentValue.strokeOpacity),p(e.options.currentValue.fillOpacity)||this.polygon.setFillOpacity(e.options.currentValue.fillOpacity),p(e.options.currentValue.strokeStyle)||this.polygon.setStrokeStyle(e.options.currentValue.strokeStyle),p(e.options.currentValue.enableMassClear)||this.polygon[e.options.currentValue.enableMassClear?"enableMassClear":"disableMassClear"](),p(e.options.currentValue.enableEditing)||this.polygon[e.options.currentValue.enableEditing?"enableEditing":"disableEditing"]()))}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.polygon)}}]),e}()},I=function(){var e=window.loadHeatMapPromise;return e||(window.loadHeatMapPromise=function e(t){return new Promise(function(n,o){var r=document.createElement("script");r.type="text/javascript",r.src=t,r.onerror=function(){document.body.removeChild(r),setTimeout(function(){e(t)},3e4)},r.onload=n,document.body.appendChild(r)})}("//api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"))};var N=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var B={bindings:{dataset:"<",options:"<",loaded:"&"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$attrs=n}return e.$inject=["$scope","$attrs"],N(e,[{key:"$onInit",value:function(){var e=this;this.mapCtrl.mapReady.then(function(){return I()}).then(function(){var t=e.heatmap=new BMapLib.HeatmapOverlay(e.options);return e.mapCtrl.addOverlay(t),t}).then(function(t){e.loaded({heatmap:t}),e.$scope.$apply(),e.dataset&&t.setDataSet(e.dataset)})}},{key:"$onChanges",value:function(e){this.heatmap&&(e.options&&e.options.currentValue&&this.heatmap.setOptions(e.options.currentValue),e.dataset&&e.dataset.currentValue&&this.heatmap.setDataSet(e.dataset.currentValue))}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.heatmap)}}]),e}()},R=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var L={bindings:{type:"@",options:"<"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return R(e,[{key:"$onInit",value:function(){var e=this;!function(e){if(f.indexOf((e||"").toLowerCase())<0)throw new Error("control type should be one of: ["+f.join(",")+"]")}(this.type),this.mapCtrl.mapReady.then(function(){return function(e,t){if("navigation"===e)return new BMap.NavigationControl(t);if("overviewmap"===e)return new BMap.OverviewMapControl(t);if("scale"===e)return new BMap.ScaleControl(t);if("maptype"===e)return new BMap.MapTypeControl(t);if("copyright"===e){var n=new BMap.CopyrightControl(t);return d(t.copyrights)&&t.copyrights.forEach(function(e){n.addCopyright(e)}),n}if("geolocation"===e)return new BMap.GeolocationControl(t);if("panorama"===e)return new BMap.PanoramaControl(t)}(e.type.toLowerCase(),e.options)}).then(function(t){return e.mapCtrl.addControl(t),e.control=t,t})}},{key:"$onDestroy",value:function(){this.mapCtrl.removeControl(this.control)}}]),e}()};var j=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var q={bindings:{type:"@",options:"<",dataset:"<"},require:{mapCtrl:"^baiduMap"},template:"",controller:function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return j(e,[{key:"$onInit",value:function(){var e=this;!function(e){if(y.indexOf((e||"").toLowerCase())<0)throw new Error("overlay type should be one of: ["+y.join(",")+"]")}(this.type),this.realType=this.type.toLowerCase(),this.mapCtrl.mapReady.then(function(){return function(e,t){if("heatmap"===e)return console.warn("heatmap type is deprecated, please try with new <heatmap /> component, see: https://leftstick.github.io/BaiduMapForAngularJS/#!/apidoc?api=heatmap"),function(e){return I().then(function(){return new BMapLib.HeatmapOverlay(e)})}(t)}(e.realType,e.options)}).then(function(t){return e.mapCtrl.addOverlay(t),e.overlay=t,D(e.realType,e.overlay,e.dataset),t})}},{key:"$onChanges",value:function(e){e.dataset&&e.dataset.currentValue&&D(this.realType,this.overlay,e.dataset.currentValue)}},{key:"$onDestroy",value:function(){this.mapCtrl.removeOverlay(this.overlay)}}]),e}()};function D(e,t,n){"heatmap"===e&&n&&t.setDataSet(n)}function Z(){return Array.prototype.slice.call(document.querySelectorAll("baidu-map")).forEach(function(e){e.querySelector(".baidu-map-offline")&&e.removeChild(e.querySelector(".baidu-map-offline")),e.querySelector(".baidu-map-instance").style.display="block"})}n.d(t,"ngBaiduMap",function(){return x}),window.BMAP_ANCHOR_TOP_LEFT=0,window.BMAP_ANCHOR_TOP_RIGHT=1,window.BMAP_ANCHOR_BOTTOM_LEFT=2,window.BMAP_ANCHOR_BOTTOM_RIGHT=3,window.BMAP_NAVIGATION_CONTROL_LARGE=0,window.BMAP_NAVIGATION_CONTROL_SMALL=1,window.BMAP_NAVIGATION_CONTROL_PAN=2,window.BMAP_NAVIGATION_CONTROL_ZOOM=3,window.BMAP_UNIT_METRIC="metric",window.BMAP_UNIT_IMPERIAL="us",window.BMAP_MAPTYPE_CONTROL_HORIZONTAL=0,window.BMAP_MAPTYPE_CONTROL_DROPDOWN=1,window.BMAP_MAPTYPE_CONTROL_MAP=2,window.BMAP_ANIMATION_DROP=1,window.BMAP_ANIMATION_BOUNCE=2,window.BMAP_POINT_SIZE_TINY=1,window.BMAP_POINT_SIZE_SMALLER=2,window.BMAP_POINT_SIZE_SMALL=3,window.BMAP_POINT_SIZE_NORMAL=4,window.BMAP_POINT_SIZE_BIG=5,window.BMAP_POINT_SIZE_BIGGER=6,window.BMAP_POINT_SIZE_HUGE=7,window.BMAP_PANORAMA_INDOOR_SCENE="inter",window.BMAP_PANORAMA_STREET_SCENE="street",window.BMAP_PANORAMA_POI_HOTEL="hotel",window.BMAP_PANORAMA_POI_CATERING="catering",window.BMAP_PANORAMA_POI_MOVIE="movie",window.BMAP_PANORAMA_POI_TRANSIT="transit",window.BMAP_PANORAMA_POI_INDOOR_SCENE="indoor_scene",window.BMAP_PANORAMA_POI_NONE="none";i.a.module("baiduMap",[]).provider("mapScriptService",function(){var e=null,t=void 0;this.setKey=function(n){t="//api.map.baidu.com/api?v=2.0&ak="+(e=n)+"&callback=baidumapinit",t=location.protocol.indexOf("http")>-1?t+"&s="+("https:"===location.protocol?1:0):"https:"+t+"&s=1"},this.$get=["$rootScope",function(n){"ngInject";return{load:function(){s(e,"ak should be set before use. Read: https://leftstick.github.io/BaiduMapForAngularJS/#!/quickstart");var o=n.loadBaiduMapPromise;return o?o.then(Z):n.loadBaiduMapPromise=new Promise(function(e,n){window.baidumapinit=e,function e(t){var n=document.createElement("script");n.type="text/javascript",n.src=t,n.onerror=function(){Array.prototype.slice.call(document.querySelectorAll("baidu-map .baidu-map-offline")).forEach(function(e){e.style.display="block"}),document.body.removeChild(n),setTimeout(function(){e(t)},3e4)},document.body.appendChild(n)}(t)}).then(Z)}}}]}).component("baiduMap",g).component("marker",P).component("polyline",$).component("circle",E).component("polygon",S).component("heatmap",B).component("control",L).component("overlay",q);var x="baiduMap"}])});